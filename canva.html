<!doctype html>
<html lang="ko" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메리츠 암보장 분석기</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- PDF.js & Tesseract.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js'></script>

    <!-- Element SDK -->
    <script src="/_sdk/element_sdk.js"></script>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&amp;family=Outfit:wght@300;400;500;600;700;800&amp;display=swap"
        rel="stylesheet">

    <!-- External Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body class="h-full" style="background:var(--bg-color); color:var(--text-color); margin:0;">
    <div id="app-wrapper" class="h-full w-full overflow-auto relative" style="background:var(--bg-color);">
        <!-- Background orbs -->
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>

        <main class="relative z-10 w-full max-w-6xl mx-auto px-4 py-8 sm:px-6 lg:px-8" role="main">
            <!-- Header -->
            <header class="text-center mb-8 stagger-in" style="animation-delay:0ms;">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium mb-4"
                    style="background:rgba(59,130,246,0.12); color:var(--primary-color); border:1px solid rgba(59,130,246,0.2);">
                    <svg width="14" height="14" viewbox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2.5">
                        <path d="M9 12l2 2 4-4" />
                        <circle cx="12" cy="12" r="10" />
                    </svg> 메리츠화재 암치료비 계산기
                </div>
                <h1 id="main-title" class="text-3xl sm:text-4xl font-extrabold tracking-tight mb-2"
                    style="font-family:'Outfit','Noto Sans KR',sans-serif; line-height:1.2;">메리츠 가입제안서 암 치료비 분석 시스템</h1>
                <p id="subtitle" class="text-sm sm:text-base" style="color:rgba(232,236,244,0.5);">가입 제안서PDF를 업로드하시면,
                    암치료비 보장내역을 추출 해드립니다!</p>
            </header>

            <!-- Upload Zone -->
            <section id="upload-section" class="stagger-in" style="animation-delay:100ms;" aria-label="파일 업로드">
                <div id="upload-zone" class="upload-zone rounded-2xl p-8 sm:p-10 text-center cursor-pointer"
                    style="background:var(--surface-color);" onclick="document.getElementById('file-input').click()">
                    <input type="file" id="file-input" accept=".pdf, .png, .jpg, .jpeg" class="hidden"
                        aria-label="파일 선택">
                    <div class="flex flex-col items-center gap-4">
                        <div class="w-16 h-16 rounded-2xl flex items-center justify-center"
                            style="background:rgba(59,130,246,0.1);">
                            <svg width="28" height="28" viewbox="0 0 24 24" fill="none" stroke="var(--primary-color)"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                <polyline points="14 2 14 8 20 8" />
                                <line x1="12" y1="18" x2="12" y2="12" />
                                <line x1="9" y1="15" x2="12" y2="12" />
                                <line x1="15" y1="15" x2="12" y2="12" />
                            </svg>
                        </div>
                        <div>
                            <p id="upload-btn-text" class="font-semibold text-base mb-1">PDF 또는 이미지 파일을 드래그하거나 클릭하세요</p>
                            <p class="text-xs" style="color:rgba(232,236,244,0.35);">메리츠 가입제안서 PDF 및 테스트용 이미지 지원</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Progress -->
            <div id="progress-section" class="hidden mt-6">
                <div class="rounded-xl p-5"
                    style="background:var(--surface-color); border:1px solid rgba(255,255,255,0.05);">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-5 h-5 border-2 border-t-transparent rounded-full animate-spin"
                            style="border-color:var(--primary-color); border-top-color:transparent;"></div>
                        <span id="progress-text" class="text-sm font-medium">PDF 분석 중...</span>
                    </div>
                    <div class="w-full h-1.5 rounded-full overflow-hidden" style="background:rgba(255,255,255,0.05);">
                        <div id="progress-bar" class="progress-bar h-full rounded-full transition-all duration-500"
                            style="width:0%;"></div>
                    </div>
                </div>
            </div>

            <!-- File Info -->
            <div id="file-info" class="hidden file-info rounded-xl p-4 mt-6 flex items-center gap-3">
                <div class="w-9 h-9 rounded-lg flex items-center justify-center flex-shrink-0"
                    style="background:rgba(59,130,246,0.15);">
                    <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="var(--primary-color)"
                        stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                        <polyline points="14 2 14 8 20 8" />
                    </svg>
                </div>
                <div class="flex-1 min-w-0">
                    <p id="file-name" class="text-sm font-medium truncate"></p>
                    <p id="file-size" class="text-xs" style="color:rgba(232,236,244,0.4);"></p>
                </div>
                <button id="reset-btn" class="text-xs px-3 py-1.5 rounded-lg font-medium transition-colors"
                    style="background:rgba(255,255,255,0.05); color:rgba(232,236,244,0.6);"
                    onmouseover="this.style.background='rgba(255,255,255,0.1)'"
                    onmouseout="this.style.background='rgba(255,255,255,0.05)'" aria-label="다시 분석하기"> 다시 분석 </button>
            </div>

            <!-- Summary -->
            <div id="summary-section" class="hidden mt-6">
                <div class="summary-card rounded-2xl p-5">
                    <div class="flex items-center gap-2 mb-4">
                        <svg width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="var(--primary-color)"
                            stroke-width="2">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                        </svg>
                        <h2 id="result-header" class="font-bold text-base"
                            style="font-family:'Outfit','Noto Sans KR',sans-serif;">가입 제안서 분석 결과</h2>
                    </div>
                    <div id="summary-grid" class="grid grid-cols-2 sm:grid-cols-3 gap-3"></div>
                </div>
            </div>

            <!-- Results -->
            <section id="results-section" class="hidden mt-6 space-y-3" aria-label="분석 결과">
                <div class="flex items-center justify-between mb-1">
                    <h3 class="text-sm font-semibold" style="color:rgba(232,236,244,0.6);">상세 보장 항목</h3>
                    <button id="expand-all-btn" class="text-xs px-2.5 py-1 rounded-lg font-medium transition-colors"
                        style="background:rgba(59,130,246,0.1); color:var(--primary-color);" aria-label="모두 펼치기"> 모두 펼치기
                    </button>
                </div>
                <div id="results-list"></div>
            </section>

            <!-- Empty State -->
            <div id="empty-state" class="hidden mt-8 text-center empty-state py-10">
                <svg width="48" height="48" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2"
                    class="mx-auto mb-3" style="opacity:0.3;">
                    <circle cx="11" cy="11" r="8" />
                    <path d="m21 21-4.3-4.3" />
                </svg>
                <p class="text-sm font-medium mb-1">분석 결과가 없습니다</p>
                <p class="text-xs">암 관련 보장 항목을 찾을 수 없습니다. 메리츠 가입제안서 PDF인지 확인해주세요.</p>
            </div>

            <!-- Raw text debug (hidden by default) -->
            <details id="debug-section" class="hidden mt-8">
                <summary class="text-xs cursor-pointer" style="color:rgba(232,236,244,0.3);">추출된 텍스트 확인 (디버그)</summary>
                <pre id="raw-text" class="mt-2 text-xs p-4 rounded-xl overflow-auto max-h-48"
                    style="background:var(--surface-color); color:rgba(232,236,244,0.4); white-space:pre-wrap; word-break:break-all;"></pre>
            </details>
        </main>

        <!-- Toast -->
        <div id="toast"
            class="toast fixed bottom-6 left-1/2 -translate-x-1/2 z-50 px-5 py-3 rounded-xl text-sm font-medium shadow-xl"
            style="background:#EF4444; color:white;"></div>
    </div>

    <!-- External Script -->
    <script src="script.js"></script>

    <!-- Original Cloudflare/Environment Script (Preserved) -->
    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'9cb3b427c20ae706',t:'MTc3MDY0MzY0MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>